from pwn import *
context.log_level = 'debug'

p = process('./arraystore')
elf = ELF('./arraystore')
libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')

def read(index):
    p.sendlineafter(b'?: ',b'R')
    p.sendlineafter(b'Index: ',str(index))
    p.recvuntil(b'Value: ')
    result = int(p.recvline()[:-1],16)
    print(hex(result))

def write(index, value):
    p.sendlineafter(b'?: ',b'W')
    p.sendlineafter(b'Index: ',str(index))
    p.sendlineafter(b'Value: ',str(value))

read(1)
write(1,13)
read(1)
p.interactive()
